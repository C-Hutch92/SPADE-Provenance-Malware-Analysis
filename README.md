# SPADE_Provenance_Analysis
## Headline
Using SPADE system provenance (https://github.com/ashish-gehani/SPADE), Doc2Vec and an Anomaly Detection System for Malware Identification.

## Purpose
I have decided to make this work open source because of the lack of information around SPADE and its integration with Neo4j and Python. Detailed here, is a fully working system in python which uses two Neo4j community servers. One server hosts a benign system graph and the second server hosts a malicious system graph which have both been generated by SPADE on the same system.  
Unfortunately, I am not prepared to offer the graph databases online, due to privacy issues. But, I am hoping this project will be very useful to anyone who has managed to record their own provenance and wishes to manipulate the path data using python's juicy ML libraries.

This work is loosely based on [[1]](#1)

## Setup - Graph Databases - Useful Links
Neo4j Community Server Download: https://neo4j.com/download-center/#community  
apoc library for path finding functions (think Dijkstra and Similar): https://neo4j.com/labs/apoc/4.1/installation/  

## Setup - Python Libraries
I dont remember doing anything special regarding the python libraries used. The rule is: if its in the import list, pip install them.

## Results and Future Work
I have received mixed results from this project, but I feel like it has great potential. I might make some improvements to this project in time, but for now, it remains as is.

## Acknowledgements
This work has been completed in collaboration with the MINDS CDT in Southampton, UK. Many thanks for your support.
https://www.mindscdt.southampton.ac.uk/

## References
<a id="1">[1]</a> 
Q. Wang et al., ‘You Are What You Do: Hunting Stealthy Malware via Data Provenance Analysis’, presented at the Network and Distributed System Security Symposium, San Diego, CA, 2020. doi: 10.14722/ndss.2020.24167.
